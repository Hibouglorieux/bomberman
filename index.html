<!DOCTYPE html>
<html>
<head>
    <script src="./phaser/dist/phaser.js"></script>
	<script src="create_anim.js"></script>
</head>
<body>

    <script>
    const level = [
        [   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1],
        [   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],
        [   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1],
        [   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],
        [   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1],
        [   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],
        [   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1],
        [   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],
        [   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1],
        [   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],
        [   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   1],
        [   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],
        [   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1]
    ];
    const scale = 5;
    const speed = 7;
    const start_x = 1;
    const start_y = 1;
    const tile_size = scale * 16;
    const width = 240 * scale;
    const height = 208 * scale;
       var config = {
    type: Phaser.AUTO,
    width: width,
    height: height,
    scene: {
        preload: preload,
        create: create,
        update: update
    }
};

function get_coord_x(x)
{
    return ((x + 0.5) * tile_size);
}

function get_coord_y(y)
{
    return ((y + 0.5 - 0.25) * tile_size);
}

var game = new Phaser.Game(config);

function preload ()
{
    this.load.image('map', 'terrain.png');

    this.load.tilemapTiledJSON('tilemap', 'terrain.json');
    this.load.image('sprite', 'anim_player/B0DEATH.png');

}

function create ()
{
     key_up = this.input.keyboard.addKey('W');
     key_right = this.input.keyboard.addKey('D');
     key_bottom = this.input.keyboard.addKey('S');
     key_left = this.input.keyboard.addKey('A');

    const tilemap = this.make.tilemap({key:'tilemap'});
    tileset = tilemap.addTilesetImage('tiles', 'map');
    const map = this.add.image(width / 2, height / 2, 'map');
    map.setScale(scale);
    sprite = this.add.sprite(get_coord_x(start_x), get_coord_y(start_y), 'sprite');
    sprite.setScale(scale);
    // var sprites = map.createFromObjects('sprite', 10, null);
        create_anim();
        let W_player = this.add.sprite(500, 500, 'w_up_0');
        W_player.play('w_up');
        // this.add.sprite(200, 200, 'explo-0-mid').play('explo_mid');
        // this.add.sprite(184, 200, 'explo-0-midleft').play('explo_midleft');
        // this.add.sprite(168, 200, 'explo-0-maxleft').play('explo_maxleft');
        // this.add.sprite(200,184, 'explo-0-midtop').play('explo_midtop');
        // this.add.sprite(200,168, 'explo-0-midtop').play('explo_midtop');
        // this.add.sprite(200,152, 'explo-0-midtop').play('explo_midtop');
        // this.add.sprite(200,136, 'explo-0-maxtop').play('explo_maxtop');
        // this.add.sprite(216,200, 'explo-0-midright').play('explo_midright');
        // this.add.sprite(232,200, 'explo-0-maxright').play('explo_maxright');
        // this.add.sprite(200, 216, 'explo-0-middown').play('explo_middown');
        // this.add.sprite(200, 232, 'explo-0-maxdown').play('explo_maxdown');
}

function update ()
{
    if (key_up.isDown)
    {
        sprite.y -= speed;
    }
     if (key_bottom.isDown)
    {
        sprite.y += speed;
    }
     if (key_left.isDown)
    {
        sprite.x -= speed;
    }
     if (key_right.isDown)
    {
        sprite.x += speed;
    }
}
    var config = {
        type: Phaser.AUTO,
        width: 800,
        height: 600,
        physics: {
            default: 'arcade',
            arcade: {
                gravity: { y: 200 }
            }
        },
        scene: {
            preload: preload,
            create: create
        }
    };

    var game = new Phaser.Game(config);

    function preload ()
    {
		//player movement
		this.load.image('w_up_0', 'anim_player/W_UP_0.png');
		this.load.image('w_up_1', 'anim_player/W_UP_1.png');
		this.load.image('w_up_2', 'anim_player/W_UP_2.png');
		this.load.image('w_down_0', 'anim_player/W_DOWN_0.png');
		this.load.image('w_down_1', 'anim_player/W_DOWN_1.png');
		this.load.image('w_down_2', 'anim_player/W_DOWN_2.png');
		this.load.image('w_left_0', 'anim_player/W_LEFT_0.png');
		this.load.image('w_left_1', 'anim_player/W_LEFT_1.png');
		this.load.image('w_left_2', 'anim_player/W_LEFT_2.png');
		this.load.image('w_right_0', 'anim_player/W_RIGHT_0.png');
		this.load.image('w_right_1', 'anim_player/W_RIGHT_1.png');
		this.load.image('w_right_2', 'anim_player/W_RIGHT_2.png');
		this.load.image('explo-0-mid', 'anim_bombs/MID_EXPLO_3.png');
		this.load.image('explo-1-mid', 'anim_bombs/MID_EXPLO_2.png');
		this.load.image('explo-2-mid', 'anim_bombs/MID_EXPLO_1.png');
		this.load.image('explo-3-mid', 'anim_bombs/MID_EXPLO_0.png');
		this.load.image('explo-0-midleft', 'anim_bombs/M_LEFT_EXPLO_3.png');
		this.load.image('explo-1-midleft', 'anim_bombs/M_LEFT_EXPLO_2.png');
		this.load.image('explo-2-midleft', 'anim_bombs/M_LEFT_EXPLO_1.png');
		this.load.image('explo-3-midleft', 'anim_bombs/M_LEFT_EXPLO_0.png');
		this.load.image('explo-0-maxleft', 'anim_bombs/T_LEFT_EXPLO_3.png');
		this.load.image('explo-1-maxleft', 'anim_bombs/T_LEFT_EXPLO_2.png');
		this.load.image('explo-2-maxleft', 'anim_bombs/T_LEFT_EXPLO_1.png');
		this.load.image('explo-3-maxleft', 'anim_bombs/T_LEFT_EXPLO_0.png');
		this.load.image('explo-0-midtop', 'anim_bombs/M_UP_EXPLO_3.png');
		this.load.image('explo-1-midtop', 'anim_bombs/M_UP_EXPLO_2.png');
		this.load.image('explo-2-midtop', 'anim_bombs/M_UP_EXPLO_1.png');
		this.load.image('explo-3-midtop', 'anim_bombs/M_UP_EXPLO_0.png');
		this.load.image('explo-0-maxtop', 'anim_bombs/T_UP_EXPLO_3.png');
		this.load.image('explo-1-maxtop', 'anim_bombs/T_UP_EXPLO_2.png');
		this.load.image('explo-2-maxtop', 'anim_bombs/T_UP_EXPLO_1.png');
		this.load.image('explo-3-maxtop', 'anim_bombs/T_UP_EXPLO_0.png');
		this.load.image('explo-0-middown', 'anim_bombs/M_DOWN_EXPLO_3.png');
		this.load.image('explo-1-middown', 'anim_bombs/M_DOWN_EXPLO_2.png');
		this.load.image('explo-2-middown', 'anim_bombs/M_DOWN_EXPLO_1.png');
		this.load.image('explo-3-middown', 'anim_bombs/M_DOWN_EXPLO_0.png');
		this.load.image('explo-0-maxdown', 'anim_bombs/T_DOWN_EXPLO_3.png');
		this.load.image('explo-1-maxdown', 'anim_bombs/T_DOWN_EXPLO_2.png');
		this.load.image('explo-2-maxdown', 'anim_bombs/T_DOWN_EXPLO_1.png');
		this.load.image('explo-3-maxdown', 'anim_bombs/T_DOWN_EXPLO_0.png');
		this.load.image('explo-0-midright', 'anim_bombs/M_RIGHT_EXPLO_3.png');
		this.load.image('explo-1-midright', 'anim_bombs/M_RIGHT_EXPLO_2.png');
		this.load.image('explo-2-midright', 'anim_bombs/M_RIGHT_EXPLO_1.png');
		this.load.image('explo-3-midright', 'anim_bombs/M_RIGHT_EXPLO_0.png');
		this.load.image('explo-0-maxright', 'anim_bombs/T_RIGHT_EXPLO_3.png');
		this.load.image('explo-1-maxright', 'anim_bombs/T_RIGHT_EXPLO_2.png');
		this.load.image('explo-2-maxright', 'anim_bombs/T_RIGHT_EXPLO_1.png');
		this.load.image('explo-3-maxright', 'anim_bombs/T_RIGHT_EXPLO_0.png');
    }
    </script>

</body>
</html>
